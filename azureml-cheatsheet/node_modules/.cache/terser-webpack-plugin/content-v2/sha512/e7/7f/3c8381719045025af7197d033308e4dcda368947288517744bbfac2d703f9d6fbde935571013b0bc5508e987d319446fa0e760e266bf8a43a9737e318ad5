{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{106:function(e,n,t){\"use strict\";t.d(n,\"a\",(function(){return m})),t.d(n,\"b\",(function(){return u}));var a=t(0),r=t.n(a);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=r.a.createContext({}),p=function(e){var n=r.a.useContext(s),t=n;return e&&(t=\"function\"==typeof e?e(n):c(c({},n),e)),t},m=function(e){var n=p(e.components);return r.a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:\"code\",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},b=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,s=l(e,[\"components\",\"mdxType\",\"originalType\",\"parentName\"]),m=p(t),b=a,u=m[\"\".concat(i,\".\").concat(b)]||m[b]||d[b]||o;return t?r.a.createElement(u,c(c({ref:n},s),{},{components:t})):r.a.createElement(u,c({ref:n},s))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if(\"string\"==typeof e||a){var o=t.length,i=new Array(o);i[0]=b;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType=\"string\"==typeof e?e:a,i[1]=c;for(var s=2;s<o;s++)i[s]=t[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}b.displayName=\"MDXCreateElement\"},60:function(e,n,t){\"use strict\";t.r(n),t.d(n,\"frontMatter\",(function(){return i})),t.d(n,\"metadata\",(function(){return c})),t.d(n,\"rightToc\",(function(){return l})),t.d(n,\"default\",(function(){return p}));var a=t(2),r=t(6),o=(t(0),t(106)),i={title:\"Environment\"},c={unversionedId:\"environment\",id:\"environment\",isDocsHomePage:!1,title:\"Environment\",description:\"Create Environments\",source:\"@site/docs/environment.md\",slug:\"/environment\",permalink:\"/azureml-cheatsheet/docs/next/environment\",editUrl:\"https://github.com/facebook/docusaurus/edit/master/website/docs/environment.md\",version:\"current\",sidebar:\"mainSidebar\",previous:{title:\"Compute Target\",permalink:\"/azureml-cheatsheet/docs/next/compute-targets\"},next:{title:\"Running Code in the Cloud\",permalink:\"/azureml-cheatsheet/docs/next/train-cloud\"}},l=[{value:\"Create Environments\",id:\"create-environments\",children:[{value:\"From pip\",id:\"from-pip\",children:[]},{value:\"From Conda\",id:\"from-conda\",children:[]},{value:\"Quick n&#39; Dirty (aka &quot;From SDK&quot;)\",id:\"quick-n-dirty-aka-from-sdk\",children:[]}]},{value:\"Registered Environments\",id:\"registered-environments\",children:[]},{value:\"(Advanced) Custom Docker Images\",id:\"advanced-custom-docker-images\",children:[{value:\"Provide Python packages to the custom image\",id:\"provide-python-packages-to-the-custom-image\",children:[]},{value:\"Use Python interpreter from the custom image\",id:\"use-python-interpreter-from-the-custom-image\",children:[]}]}],s={rightToc:l};function p(e){var n=e.components,t=Object(r.a)(e,[\"components\"]);return Object(o.b)(\"wrapper\",Object(a.a)({},s,t,{components:n,mdxType:\"MDXLayout\"}),Object(o.b)(\"h2\",{id:\"create-environments\"},\"Create Environments\"),Object(o.b)(\"p\",null,\"Easily create, maintain and share Python environments with pip and Conda, or directly from the Python SDK.\"),Object(o.b)(\"h3\",{id:\"from-pip\"},\"From pip\"),Object(o.b)(\"p\",null,\"Create Environment from pip \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"requirements.txt\"),\" file\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"from azureml.core import Environment\\nenv = Environment.from_pip_requirements('<environment-name>', '<path/to/requirements.txt>')\\n\")),Object(o.b)(\"h3\",{id:\"from-conda\"},\"From Conda\"),Object(o.b)(\"p\",null,\"Create Environment from Conda \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"env.yml\"),\" file\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"from azureml.core import Environment\\nenv = Environment.from_conda_specifications('<environment-name>', '<path/to/env.yml>')\\n\")),Object(o.b)(\"h3\",{id:\"quick-n-dirty-aka-from-sdk\"},'Quick n\\' Dirty (aka \"From SDK\")'),Object(o.b)(\"p\",null,\"Sometimes you want to get something up and running quickly without the need for \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"env.yml\"),\"\\nor \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"requirement.txt\"),\" files. In such cases you can make use of \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"CondaDependencies\"),\".\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"from azureml.core.conda_dependencies import CondaDependencies\\n\\nconda = CondaDependencies()\\n\\n# add channels\\nconda.add_channel('pytorch')\\n\\n# add conda packages\\nconda.add_conda_package('python=3.7')\\nconda.add_conda_package('pytorch')\\nconda.add_conda_package('torchvision')\\n\\n# add pip packages\\nconda.add_pip_package('pyyaml')\\n\")),Object(o.b)(\"p\",null,\"Which can be consumed by an environment as follows.\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"from azureml.core import Environment\\nenv = Environment('pytorch')\\nenv.python.conda_dependencies = conda\\n\")),Object(o.b)(\"p\",null,\"Converting the conda_dependencies to an \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"env.yml\"),\" file later is easy:\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"conda.save('env.yml')\\n\")),Object(o.b)(\"p\",null,\"This example will generate the following file:\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-yml\",metastring:'title=\"env.yml\"',title:'\"env.yml\"'}),\"# Conda environment specification. The dependencies defined in this file will\\n# be automatically provisioned for runs with userManagedDependencies=False.\\n\\n# Details about the Conda environment file format:\\n# https://conda.io/docs/user-guide/tasks/manage-environments.html#create-env-file-manually\\n\\nname: project_environment\\ndependencies:\\n  # The python interpreter version.\\n  # Currently Azure ML only supports 3.5.2 and later.\\n- python=3.7\\n\\n- pip:\\n    # Required packages for AzureML execution, history, and data preparation.\\n  - azureml-defaults\\n\\n  - pyyaml\\n- pytorch\\n- torchvision\\nchannels:\\n- anaconda\\n- conda-forge\\n- pytorch\\n\")),Object(o.b)(\"h2\",{id:\"registered-environments\"},\"Registered Environments\"),Object(o.b)(\"p\",null,\"Register an environment \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"env: Environment\"),\" to your workspace to reuse/share with your team.\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"env.register(ws)\\n\")),Object(o.b)(\"p\",null,\"To see the registerd Environments already available:\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"from azureml.core import Environment\\nenvs: Dict[str, Environment] = Environment.list(ws)\\n\\nfor name, env in envs.items():\\n    print(name)\\n# AzureML-Chainer-5.1.0-GPU\\n# AzureML-Scikit-learn-0.20.3\\n# AzureML-PyTorch-1.1-GPU\\n# ...\\n\")),Object(o.b)(\"p\",null,\"This list contains custom environments that have been registered to the workspace as well as a\\ncollection of \",Object(o.b)(\"em\",{parentName:\"p\"},\"curated environments\"),\" maintained by the Azure ML team.\"),Object(o.b)(\"p\",null,\"List the conda dependencies for a given environment, for example in 'AzureML-Chainer-5.1.0-GPU':\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"env = envs['AzureML-PyTorch-1.1-GPU']\\nprint(env.python.conda_dependencies.serialize_to_string())\\n\")),Object(o.b)(\"p\",null,\"Which returns the following.\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-yaml\",metastring:'title=\"AzureML-PyTorch-1.1-GPU Conda Dependencies\"',title:'\"AzureML-PyTorch-1.1-GPU',Conda:!0,'Dependencies\"':!0}),\"channels:\\n- conda-forge\\ndependencies:\\n- python=3.6.2\\n- pip:\\n  - azureml-core==1.15.0\\n  - azureml-defaults==1.15.0\\n  - azureml-telemetry==1.15.0\\n  - azureml-train-restclients-hyperdrive==1.15.0\\n  - azureml-train-core==1.15.0\\n  - torch==1.1\\n  - torchvision==0.2.1\\n  - mkl==2018.0.3\\n  - horovod==0.16.1\\n  - tensorboard==1.14.0\\n  - future==0.17.1\\nname: azureml_eb61e39e20e87ad998ae2c88df1dd0af\\n\")),Object(o.b)(\"h2\",{id:\"advanced-custom-docker-images\"},\"(Advanced) Custom Docker Images\"),Object(o.b)(\"p\",null,\"By default, Azure ML will create your Python environment inside a Docker image it maintains.\"),Object(o.b)(\"div\",{className:\"admonition admonition-info alert alert--info\"},Object(o.b)(\"div\",Object(a.a)({parentName:\"div\"},{className:\"admonition-heading\"}),Object(o.b)(\"h5\",{parentName:\"div\"},Object(o.b)(\"span\",Object(a.a)({parentName:\"h5\"},{className:\"admonition-icon\"}),Object(o.b)(\"svg\",Object(a.a)({parentName:\"span\"},{xmlns:\"http://www.w3.org/2000/svg\",width:\"14\",height:\"16\",viewBox:\"0 0 14 16\"}),Object(o.b)(\"path\",Object(a.a)({parentName:\"svg\"},{fillRule:\"evenodd\",d:\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"})))),\"No secrets\")),Object(o.b)(\"div\",Object(a.a)({parentName:\"div\"},{className:\"admonition-content\"}),Object(o.b)(\"p\",{parentName:\"div\"},\"This default image is not a secret. For example, you can see the Dockerfile used to create\\nit with the following:\"),Object(o.b)(\"pre\",{parentName:\"div\"},Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"env = Environment('no-secrets')             # create new Environment\\nenv.regester(ws)                            # register to the workspace\\ndetails = env.get_image_details(ws)\\nprint(details['ingredients']['dockerfile'])\\n\")))),Object(o.b)(\"p\",null,\"You may chose to use your own Docker image. In this case there are two options:\"),Object(o.b)(\"h3\",{id:\"provide-python-packages-to-the-custom-image\"},\"Provide Python packages to the custom image\"),Object(o.b)(\"p\",null,\"In this case we will use pip, Conda or the SDK to manage our Python packages as above, resulting\\nin \",Object(o.b)(\"inlineCode\",{parentName:\"p\"},\"env: Environment\"),\". For example,\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"env = Environment.from_pip_requirements('nlp', 'requirements.txt')\\n\")),Object(o.b)(\"p\",null,\"Assuming you have a Dockerfile to hand you can specify the following:\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),'  # just as an example\\nenv.docker.base_image = None                    # translation: do not use your default base image\\nenv.docker.base_dockerfile = \"./Dockerfile\"     # translation: use my Dockerfile as base instead\\n')),Object(o.b)(\"p\",null,\"When you use this environment in a compute target it will build a Docker image as follows:\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-docker\"}),\"###\\nContents of your base dockerfile\\n###\\n\\n###\\nBuild the Python dependencies as specified in env object\\n###\\n\")),Object(o.b)(\"div\",{className:\"admonition admonition-info alert alert--info\"},Object(o.b)(\"div\",Object(a.a)({parentName:\"div\"},{className:\"admonition-heading\"}),Object(o.b)(\"h5\",{parentName:\"div\"},Object(o.b)(\"span\",Object(a.a)({parentName:\"h5\"},{className:\"admonition-icon\"}),Object(o.b)(\"svg\",Object(a.a)({parentName:\"span\"},{xmlns:\"http://www.w3.org/2000/svg\",width:\"14\",height:\"16\",viewBox:\"0 0 14 16\"}),Object(o.b)(\"path\",Object(a.a)({parentName:\"svg\"},{fillRule:\"evenodd\",d:\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"})))),\"info\")),Object(o.b)(\"div\",Object(a.a)({parentName:\"div\"},{className:\"admonition-content\"}),Object(o.b)(\"p\",{parentName:\"div\"},\"Again, you can see the exact contents of this Dockerfile used by running\"),Object(o.b)(\"pre\",{parentName:\"div\"},Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),\"details = env.get_image_details(ws)\\nprint(details['ingredients']['dockerfile'])\\n\")))),Object(o.b)(\"h3\",{id:\"use-python-interpreter-from-the-custom-image\"},\"Use Python interpreter from the custom image\"),Object(o.b)(\"p\",null,\"Usually your custom Docker image has its own Python environment already set up.\"),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-docker\",metastring:'title=\"Dockerfile\"',title:'\"Dockerfile\"'}),'FROM mcr.microsoft.com/azureml/base:intelmpi2018.3-ubuntu16.04\\nRUN conda update -n base -c defaults conda\\nRUN [ \"/bin/bash\", \"-c\", \"conda create -n pytorch Python=3.6.2 && source activate amlbert && conda install pip\"]\\nRUN /opt/miniconda/envs/pytorch/bin/pip install pytorch\\n')),Object(o.b)(\"p\",null,\"In this case you need to:\"),Object(o.b)(\"ul\",null,Object(o.b)(\"li\",{parentName:\"ul\"},\"Indicate that you are managing your own Python dependencies: \",Object(o.b)(\"inlineCode\",{parentName:\"li\"},\"user_managed_dependencies=True\")),Object(o.b)(\"li\",{parentName:\"ul\"},\"Specify the path to your Python interpreter: \",Object(o.b)(\"inlineCode\",{parentName:\"li\"},\"interpreter_path=<path>\"))),Object(o.b)(\"pre\",null,Object(o.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-python\"}),'env = Environment(\\'pytorch\\')\\n\\n# set up custom docker image\\nenv.docker.base_image = None\\nenv.docker.base_dockerfile = \"./Dockerfile\"\\n\\n# indicate how to run Python\\nenv.python.user_managed_dependencies=True\\nenv.python.interpreter_path = \"/opt/miniconda/bin/python\"\\n')))}p.isMDXComponent=!0}}]);","name":"177b04f3.2386decf.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[7],{\n\n/***/ 106:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export MDXContext */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return MDXProvider; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return createElement; });\n/* unused harmony export useMDXComponents */\n/* unused harmony export withMDXComponents */\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nvar isFunction = function isFunction(obj) {\n  return typeof obj === 'function';\n};\n\nvar MDXContext = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createContext({});\nvar withMDXComponents = function withMDXComponents(Component) {\n  return function (props) {\n    var allComponents = useMDXComponents(props.components);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _extends({}, props, {\n      components: allComponents\n    }));\n  };\n};\nvar useMDXComponents = function useMDXComponents(components) {\n  var contextComponents = react__WEBPACK_IMPORTED_MODULE_0___default.a.useContext(MDXContext);\n  var allComponents = contextComponents;\n\n  if (components) {\n    allComponents = isFunction(components) ? components(contextComponents) : _objectSpread2(_objectSpread2({}, contextComponents), components);\n  }\n\n  return allComponents;\n};\nvar MDXProvider = function MDXProvider(props) {\n  var allComponents = useMDXComponents(props.components);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MDXContext.Provider, {\n    value: allComponents\n  }, props.children);\n};\n\nvar TYPE_PROP_NAME = 'mdxType';\nvar DEFAULTS = {\n  inlineCode: 'code',\n  wrapper: function wrapper(_ref) {\n    var children = _ref.children;\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, {}, children);\n  }\n};\nvar MDXCreateElement = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.forwardRef(function (props, ref) {\n  var propComponents = props.components,\n      mdxType = props.mdxType,\n      originalType = props.originalType,\n      parentName = props.parentName,\n      etc = _objectWithoutProperties(props, [\"components\", \"mdxType\", \"originalType\", \"parentName\"]);\n\n  var components = useMDXComponents(propComponents);\n  var type = mdxType;\n  var Component = components[\"\".concat(parentName, \".\").concat(type)] || components[type] || DEFAULTS[type] || originalType;\n\n  if (propComponents) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _objectSpread2(_objectSpread2({\n      ref: ref\n    }, etc), {}, {\n      components: propComponents\n    }));\n  }\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _objectSpread2({\n    ref: ref\n  }, etc));\n});\nMDXCreateElement.displayName = 'MDXCreateElement';\nfunction createElement (type, props) {\n  var args = arguments;\n  var mdxType = props && props.mdxType;\n\n  if (typeof type === 'string' || mdxType) {\n    var argsLength = args.length;\n    var createElementArgArray = new Array(argsLength);\n    createElementArgArray[0] = MDXCreateElement;\n    var newProps = {};\n\n    for (var key in props) {\n      if (hasOwnProperty.call(props, key)) {\n        newProps[key] = props[key];\n      }\n    }\n\n    newProps.originalType = type;\n    newProps[TYPE_PROP_NAME] = typeof type === 'string' ? type : mdxType;\n    createElementArgArray[1] = newProps;\n\n    for (var i = 2; i < argsLength; i++) {\n      createElementArgArray[i] = args[i];\n    }\n\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement.apply(null, createElementArgArray);\n  }\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement.apply(null, args);\n}\n\n\n\n\n/***/ }),\n\n/***/ 60:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"frontMatter\", function() { return frontMatter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"metadata\", function() { return metadata; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rightToc\", function() { return rightToc; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MDXContent; });\n/* harmony import */ var _home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2);\n/* harmony import */ var _home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(0);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _mdx_js_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(106);\nvar frontMatter={title:'Environment'};var metadata={\"unversionedId\":\"environment\",\"id\":\"environment\",\"isDocsHomePage\":false,\"title\":\"Environment\",\"description\":\"Create Environments\",\"source\":\"@site/docs/environment.md\",\"slug\":\"/environment\",\"permalink\":\"/azureml-cheatsheet/docs/next/environment\",\"editUrl\":\"https://github.com/facebook/docusaurus/edit/master/website/docs/environment.md\",\"version\":\"current\",\"sidebar\":\"mainSidebar\",\"previous\":{\"title\":\"Compute Target\",\"permalink\":\"/azureml-cheatsheet/docs/next/compute-targets\"},\"next\":{\"title\":\"Running Code in the Cloud\",\"permalink\":\"/azureml-cheatsheet/docs/next/train-cloud\"}};/* @jsx mdx */var rightToc=[{value:'Create Environments',id:'create-environments',children:[{value:'From pip',id:'from-pip',children:[]},{value:'From Conda',id:'from-conda',children:[]},{value:'Quick n&#39; Dirty (aka &quot;From SDK&quot;)',id:'quick-n-dirty-aka-from-sdk',children:[]}]},{value:'Registered Environments',id:'registered-environments',children:[]},{value:'(Advanced) Custom Docker Images',id:'advanced-custom-docker-images',children:[{value:'Provide Python packages to the custom image',id:'provide-python-packages-to-the-custom-image',children:[]},{value:'Use Python interpreter from the custom image',id:'use-python-interpreter-from-the-custom-image',children:[]}]}];var layoutProps={rightToc:rightToc};var MDXLayout=\"wrapper\";function MDXContent(_ref){var components=_ref.components,props=Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(_ref,[\"components\"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(MDXLayout,Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},layoutProps,props,{components:components,mdxType:\"MDXLayout\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h2\",{\"id\":\"create-environments\"},\"Create Environments\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Easily create, maintain and share Python environments with pip and Conda, or directly from the Python SDK.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"from-pip\"},\"From pip\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Create Environment from pip \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"requirements.txt\"),\" file\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"from azureml.core import Environment\\nenv = Environment.from_pip_requirements('<environment-name>', '<path/to/requirements.txt>')\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"from-conda\"},\"From Conda\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Create Environment from Conda \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"env.yml\"),\" file\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"from azureml.core import Environment\\nenv = Environment.from_conda_specifications('<environment-name>', '<path/to/env.yml>')\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"quick-n-dirty-aka-from-sdk\"},\"Quick n' Dirty (aka \\\"From SDK\\\")\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Sometimes you want to get something up and running quickly without the need for \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"env.yml\"),\"\\nor \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"requirement.txt\"),\" files. In such cases you can make use of \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"CondaDependencies\"),\".\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"from azureml.core.conda_dependencies import CondaDependencies\\n\\nconda = CondaDependencies()\\n\\n# add channels\\nconda.add_channel('pytorch')\\n\\n# add conda packages\\nconda.add_conda_package('python=3.7')\\nconda.add_conda_package('pytorch')\\nconda.add_conda_package('torchvision')\\n\\n# add pip packages\\nconda.add_pip_package('pyyaml')\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Which can be consumed by an environment as follows.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"from azureml.core import Environment\\nenv = Environment('pytorch')\\nenv.python.conda_dependencies = conda\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Converting the conda_dependencies to an \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"env.yml\"),\" file later is easy:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"conda.save('env.yml')\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"This example will generate the following file:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-yml\",\"metastring\":\"title=\\\"env.yml\\\"\",\"title\":\"\\\"env.yml\\\"\"}),\"# Conda environment specification. The dependencies defined in this file will\\n# be automatically provisioned for runs with userManagedDependencies=False.\\n\\n# Details about the Conda environment file format:\\n# https://conda.io/docs/user-guide/tasks/manage-environments.html#create-env-file-manually\\n\\nname: project_environment\\ndependencies:\\n  # The python interpreter version.\\n  # Currently Azure ML only supports 3.5.2 and later.\\n- python=3.7\\n\\n- pip:\\n    # Required packages for AzureML execution, history, and data preparation.\\n  - azureml-defaults\\n\\n  - pyyaml\\n- pytorch\\n- torchvision\\nchannels:\\n- anaconda\\n- conda-forge\\n- pytorch\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h2\",{\"id\":\"registered-environments\"},\"Registered Environments\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Register an environment \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"env: Environment\"),\" to your workspace to reuse/share with your team.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"env.register(ws)\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"To see the registerd Environments already available:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"from azureml.core import Environment\\nenvs: Dict[str, Environment] = Environment.list(ws)\\n\\nfor name, env in envs.items():\\n    print(name)\\n# AzureML-Chainer-5.1.0-GPU\\n# AzureML-Scikit-learn-0.20.3\\n# AzureML-PyTorch-1.1-GPU\\n# ...\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"This list contains custom environments that have been registered to the workspace as well as a\\ncollection of \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"em\",{parentName:\"p\"},\"curated environments\"),\" maintained by the Azure ML team.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"List the conda dependencies for a given environment, for example in 'AzureML-Chainer-5.1.0-GPU':\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"env = envs['AzureML-PyTorch-1.1-GPU']\\nprint(env.python.conda_dependencies.serialize_to_string())\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Which returns the following.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-yaml\",\"metastring\":\"title=\\\"AzureML-PyTorch-1.1-GPU Conda Dependencies\\\"\",\"title\":\"\\\"AzureML-PyTorch-1.1-GPU\",\"Conda\":true,\"Dependencies\\\"\":true}),\"channels:\\n- conda-forge\\ndependencies:\\n- python=3.6.2\\n- pip:\\n  - azureml-core==1.15.0\\n  - azureml-defaults==1.15.0\\n  - azureml-telemetry==1.15.0\\n  - azureml-train-restclients-hyperdrive==1.15.0\\n  - azureml-train-core==1.15.0\\n  - torch==1.1\\n  - torchvision==0.2.1\\n  - mkl==2018.0.3\\n  - horovod==0.16.1\\n  - tensorboard==1.14.0\\n  - future==0.17.1\\nname: azureml_eb61e39e20e87ad998ae2c88df1dd0af\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h2\",{\"id\":\"advanced-custom-docker-images\"},\"(Advanced) Custom Docker Images\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"By default, Azure ML will create your Python environment inside a Docker image it maintains.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"div\",{\"className\":\"admonition admonition-info alert alert--info\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"div\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"div\"},{\"className\":\"admonition-heading\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h5\",{parentName:\"div\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"span\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"h5\"},{\"className\":\"admonition-icon\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"svg\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"span\"},{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"14\",\"height\":\"16\",\"viewBox\":\"0 0 14 16\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"path\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"svg\"},{\"fillRule\":\"evenodd\",\"d\":\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"})))),\"No secrets\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"div\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"div\"},{\"className\":\"admonition-content\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",{parentName:\"div\"},\"This default image is not a secret. For example, you can see the Dockerfile used to create\\nit with the following:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",{parentName:\"div\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"env = Environment('no-secrets')             # create new Environment\\nenv.regester(ws)                            # register to the workspace\\ndetails = env.get_image_details(ws)\\nprint(details['ingredients']['dockerfile'])\\n\")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"You may chose to use your own Docker image. In this case there are two options:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"provide-python-packages-to-the-custom-image\"},\"Provide Python packages to the custom image\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"In this case we will use pip, Conda or the SDK to manage our Python packages as above, resulting\\nin \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"env: Environment\"),\". For example,\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"env = Environment.from_pip_requirements('nlp', 'requirements.txt')\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Assuming you have a Dockerfile to hand you can specify the following:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"  # just as an example\\nenv.docker.base_image = None                    # translation: do not use your default base image\\nenv.docker.base_dockerfile = \\\"./Dockerfile\\\"     # translation: use my Dockerfile as base instead\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"When you use this environment in a compute target it will build a Docker image as follows:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-docker\"}),\"###\\nContents of your base dockerfile\\n###\\n\\n###\\nBuild the Python dependencies as specified in env object\\n###\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"div\",{\"className\":\"admonition admonition-info alert alert--info\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"div\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"div\"},{\"className\":\"admonition-heading\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h5\",{parentName:\"div\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"span\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"h5\"},{\"className\":\"admonition-icon\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"svg\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"span\"},{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"14\",\"height\":\"16\",\"viewBox\":\"0 0 14 16\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"path\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"svg\"},{\"fillRule\":\"evenodd\",\"d\":\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"})))),\"info\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"div\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"div\"},{\"className\":\"admonition-content\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",{parentName:\"div\"},\"Again, you can see the exact contents of this Dockerfile used by running\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",{parentName:\"div\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"details = env.get_image_details(ws)\\nprint(details['ingredients']['dockerfile'])\\n\")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"use-python-interpreter-from-the-custom-image\"},\"Use Python interpreter from the custom image\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Usually your custom Docker image has its own Python environment already set up.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-docker\",\"metastring\":\"title=\\\"Dockerfile\\\"\",\"title\":\"\\\"Dockerfile\\\"\"}),\"FROM mcr.microsoft.com/azureml/base:intelmpi2018.3-ubuntu16.04\\nRUN conda update -n base -c defaults conda\\nRUN [ \\\"/bin/bash\\\", \\\"-c\\\", \\\"conda create -n pytorch Python=3.6.2 && source activate amlbert && conda install pip\\\"]\\nRUN /opt/miniconda/envs/pytorch/bin/pip install pytorch\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"In this case you need to:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"ul\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"Indicate that you are managing your own Python dependencies: \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"li\"},\"user_managed_dependencies=True\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"Specify the path to your Python interpreter: \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"li\"},\"interpreter_path=<path>\"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",Object(_home_amin_repos_AzureML_CheatSheet_azureml_cheatsheet_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({parentName:\"pre\"},{\"className\":\"language-python\"}),\"env = Environment('pytorch')\\n\\n# set up custom docker image\\nenv.docker.base_image = None\\nenv.docker.base_dockerfile = \\\"./Dockerfile\\\"\\n\\n# indicate how to run Python\\nenv.python.user_managed_dependencies=True\\nenv.python.interpreter_path = \\\"/opt/miniconda/bin/python\\\"\\n\")));};MDXContent.isMDXComponent=true;\n\n/***/ })\n\n}]);","inputSourceMap":null}